<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Ad Manager Script Generator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center">Google Ad Manager Script Generator</h1>

        <form id="scriptForm">
            <!-- Akun GAM -->
            <div class="mb-3">
                <label for="akunGAM" class="form-label">Akun GAM</label>
                <select id="akunGAM" class="form-select" required>
                    <option value="" disabled selected>Pilih Akun GAM</option>
                    <option value="21847396155">21847396155 (GAM Ayo)</option>
                    <option value="22579199035">22579199035 (GAM Promedia)</option>
                    <option value="22644494876">22644494876 (GAM Jatim)</option>
                </select>
            </div>

            <!-- Ad Unit -->
            <div class="mb-3">
                <label for="adUnit" class="form-label">Ad Unit</label>
                <select id="adUnit" class="form-select" required></select>
            </div>

            <!-- Device Category -->
            <div class="mb-3">
                <label class="form-label">Device Category</label><br>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="checkbox" id="m" value="mobile">
                    <label class="form-check-label" for="mobile">Mobile</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="checkbox" id="d" value="desktop">
                    <label class="form-check-label" for="desktop">Desktop</label>
                </div>
            </div>

            <!-- Key Value -->
            <div class="mb-3">
                <label class="form-label">Key Value</label><br>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="mobileTopHome" value="mobileTopHome">
                    <label class="form-check-label" for="mobileTopHome">mobileTopHome => [320, 100]</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="mobileBottomBannerHome" value="mobileBottomBannerHome">
                    <label class="form-check-label" for="mobileBottomBannerHome">mobileBottomBannerHome => [300, 600],[320, 480],[300, 250]</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="desktopTopHome" value="desktopTopHome">
                    <label class="form-check-label" for="desktopTopHome">desktopTopHome => [970, 250],[970, 90],[728, 250],[728, 90]</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="desktopGiantHome" value="desktopGiantHome">
                    <label class="form-check-label" for="desktopGiantHome">desktopGiantHome => [300, 600]</label>
                </div>
            </div>

            <button type="submit" class="btn btn-primary">Generate Script</button>
        </form>

        <h2 class="mt-5 d-flex justify-content-between align-items-center">
            Generated Script for Mobile
            <button id="copyMobile" class="btn btn-sm btn-secondary">Copy</button>
        </h2>
        <pre id="mobileGeneratedScript" class="bg-light p-3 border"></pre>
        
        <h2 class="mt-5 d-flex justify-content-between align-items-center">
            Generated Script for Desktop
            <button id="copyDesktop" class="btn btn-sm btn-secondary">Copy</button>
        </h2>
        <pre id="desktopGeneratedScript" class="bg-light p-3 border"></pre>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

    <script>
        // Example Ad Unit Data
        const adUnits = [
            "ayobandung.com", "ayojakarta.com", "ayojogja.com", "ayobogor.com", "ayosemarang.com"
        ];
    
        // Initialize Ad Unit Select with Search Feature
        $(document).ready(() => {
            $('#adUnit').select2({
                data: adUnits.map(adUnit => ({ id: adUnit, text: adUnit })),
                placeholder: "Pilih Ad Unit",
                allowClear: true
            });
        });
    
        // Key Value Slot Sizes
        const keyValueSlotSizes = {
            "mobileTopHome": [[320, 100]],
            "mobileBottomBannerHome": [[300, 600], [320, 480], [300, 250]],
            "desktopTopHome": [[970, 250], [970, 90], [728, 250], [728, 90]],
            "desktopGiantHome": [[300, 600]]
        };
    
        // Logika untuk mengatur keyValue yang dapat dipilih berdasarkan Device Category
        document.querySelectorAll('input[type=checkbox][id^="mobile"], input[type=checkbox][id^="desktop"]').forEach(el => {
            el.disabled = true; // Awalnya semua keyValue dimatikan
        });
    
        document.querySelectorAll('input[type=checkbox][id$="m"], input[type=checkbox][id$="d"]').forEach(categoryCheckbox => {
            categoryCheckbox.addEventListener('change', () => {
                const isMobileSelected = document.getElementById('m').checked;
                const isDesktopSelected = document.getElementById('d').checked;
    
                document.querySelectorAll('input[type=checkbox][id^="mobile"]').forEach(el => {
                    el.disabled = !isMobileSelected; // Aktifkan mobile keyValues hanya jika kategori mobile dipilih
                    el.checked = false; // Hapus ceklis otomatis jika sebelumnya aktif
                });
    
                document.querySelectorAll('input[type=checkbox][id^="desktop"]').forEach(el => {
                    el.disabled = !isDesktopSelected; // Aktifkan desktop keyValues hanya jika kategori desktop dipilih
                    el.checked = false; // Hapus ceklis otomatis jika sebelumnya aktif
                });
            });
        });
    
        document.getElementById('scriptForm').addEventListener('submit', (e) => {
    e.preventDefault();

    const akunGAM = document.getElementById('akunGAM').value;
    const adUnit = $('#adUnit').val();
    const deviceCategories = Array.from(
        document.querySelectorAll('input[type=checkbox][id$="m"], input[type=checkbox][id$="d"]:checked')
    ).map(input => input.value);

    if (!deviceCategories.length) {
        alert('Pilih setidaknya satu Device Category.');
        return;
    }

    const keyValues = Array.from(
        document.querySelectorAll('input[type=checkbox][id^="mobile"]:checked, input[type=checkbox][id^="desktop"]:checked')
    ).map(input => input.value);

    if (!keyValues.length) {
        alert('Pilih setidaknya satu Key Value yang sesuai dengan Device Category.');
        return;
    }

    // Filter KeyValues Berdasarkan Device Category
    const mobileKeyValues = keyValues.filter(keyValue => keyValue.startsWith('mobile'));
    const desktopKeyValues = keyValues.filter(keyValue => keyValue.startsWith('desktop'));

    const generateScripts = (keyValues, device) => {
        return keyValues.map(keyValue => {
            const sizes = keyValueSlotSizes[keyValue];
            if (!sizes) {
                console.error(`Slot sizes not found for keyValue: ${keyValue}`);
                return '';
            }
            const sizesString = JSON.stringify(sizes).replace(/\[|\]/g, "").split(",").map(x => `[${x}]`).join(",");
            return `googletag.defineSlot('/${akunGAM}/${adUnit}/${device}', [${sizesString}], 'div-gpt-ad-${keyValue}').setTargeting('Position', ['${keyValue}']).addService(googletag.pubads());`;
        }).join('\n');
    };

    // Generate scripts for mobile and desktop
    const mobileScripts = generateScripts(mobileKeyValues, 'mobile');
    const desktopScripts = generateScripts(desktopKeyValues, 'desktop');

    // Display scripts in respective areas
    document.getElementById('mobileGeneratedScript').textContent = mobileScripts || 'No scripts generated for mobile.';
    document.getElementById('desktopGeneratedScript').textContent = desktopScripts || 'No scripts generated for desktop.';
});

// Copy script functionality
const copyToClipboard = (elementId) => {
    const text = document.getElementById(elementId).textContent;
    navigator.clipboard.writeText(text).then(() => {
        alert('Script copied to clipboard!');
    }).catch(err => {
        console.error('Failed to copy text: ', err);
    });
};

document.getElementById('copyMobile').addEventListener('click', () => {
    copyToClipboard('mobileGeneratedScript');
});

document.getElementById('copyDesktop').addEventListener('click', () => {
    copyToClipboard('desktopGeneratedScript');
});
    </script>
    </body>
</html>
